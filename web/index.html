<!DOCTYPE html>
<html>

<head>
  <!--
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
  -->
  <base href="$FLUTTER_BASE_HREF">

  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="Metropolitan Investment - Professional Investment Management Platform.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- iOS meta tags & icons -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Metropolitan Investment">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png" />

  <!-- PWA meta tags -->
  <meta name="theme-color" content="#0D1B2A">

  <!-- Security headers -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">

  <!-- SEO meta tags -->
  <meta name="keywords" content="investment, finance, portfolio management, bonds, shares, loans, apartments">
  <meta name="author" content="Metropolitan Investment">
  <meta property="og:title" content="Metropolitan Investment">
  <meta property="og:description" content="Professional Investment Management Platform">
  <meta property="og:type" content="website">

  <title>Metropolitan Investment</title>
  <link rel="manifest" href="manifest.json">

  <!-- Loading styles -->
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap');

    :root {
      /* Professional Financial Theme colors from AppThemePro */
      --primary-dark: #0B1426;
      --primary-medium: #1E2A47;
      --primary-light: #2D3E63;
      --accent-gold: #FFD700;
      --accent-gold-muted: #E6C200;
      --accent-gold-dark: #B8860B;
      --text-primary: #FFFFFF;
      --text-secondary: #E5E7EB;
      --text-tertiary: #D1D5DB;
      --background-primary: #0F172A;
      --background-secondary: #1E293B;
      --surface-card: #1E293B;
      --border-primary: #374151;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      overflow: hidden;
      background: var(--background-primary);
    }

    .loading-container {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      width: 100vw;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 9999;
      background: linear-gradient(135deg,
          var(--primary-dark) 0%,
          var(--primary-medium) 30%,
          var(--primary-light) 70%,
          var(--background-secondary) 100%);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      backdrop-filter: blur(20px);
    }

    .loading-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background:
        radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 215, 0, 0.06) 0%, transparent 50%),
        radial-gradient(circle at 40% 80%, rgba(46, 62, 99, 0.4) 0%, transparent 50%);
      animation: backgroundShift 8s ease-in-out infinite;
    }

    .loading-container.fade-out {
      opacity: 0;
      transform: scale(0.95);
      pointer-events: none;
    }

    /* Floating particles animation */
    .particles {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 1;
    }

    .particle {
      position: absolute;
      background: var(--accent-gold);
      border-radius: 50%;
      opacity: 0.6;
      animation: float 6s ease-in-out infinite;
    }

    .particle:nth-child(1) {
      width: 3px;
      height: 3px;
      top: 20%;
      left: 10%;
      animation-delay: 0s;
    }

    .particle:nth-child(2) {
      width: 5px;
      height: 5px;
      top: 60%;
      left: 90%;
      animation-delay: 2s;
    }

    .particle:nth-child(3) {
      width: 2px;
      height: 2px;
      top: 80%;
      left: 20%;
      animation-delay: 4s;
    }

    .particle:nth-child(4) {
      width: 4px;
      height: 4px;
      top: 30%;
      left: 80%;
      animation-delay: 1s;
    }

    .particle:nth-child(5) {
      width: 3px;
      height: 3px;
      top: 70%;
      left: 60%;
      animation-delay: 3s;
    }

    /* Main content container */
    .content-wrapper {
      position: relative;
      z-index: 10;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    /* Logo container with premium effects */
    .logo-container {
      position: relative;
      margin-bottom: 48px;
      perspective: 1000px;
    }

    .logo-wrapper {
      position: relative;
      width: 160px;
      height: 160px;
      transform-style: preserve-3d;
      animation: logoFloat 4s ease-in-out infinite;
    }

    .logo-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, var(--accent-gold), var(--accent-gold-dark));
      border-radius: 50%;
      filter: blur(20px);
      opacity: 0.3;
      animation: pulseGlow 3s ease-in-out infinite;
    }

    .logo-ring {
      position: absolute;
      top: -10px;
      left: -10px;
      width: 180px;
      height: 180px;
      border: 2px solid var(--accent-gold);
      border-radius: 50%;
      opacity: 0.6;
      animation: rotate 20s linear infinite;
    }

    .logo-ring::before {
      content: '';
      position: absolute;
      top: -6px;
      left: 50%;
      transform: translateX(-50%);
      width: 12px;
      height: 12px;
      background: var(--accent-gold);
      border-radius: 50%;
      box-shadow: 0 0 20px var(--accent-gold);
    }

    .logo {
      position: relative;
      width: 160px;
      height: 160px;
      background: linear-gradient(135deg, var(--surface-card), var(--primary-medium));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 3px solid var(--border-primary);
      box-shadow:
        0 20px 40px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 0 60px rgba(255, 215, 0, 0.2);
      backdrop-filter: blur(10px);
      animation: logoRotate 8s ease-in-out infinite;
      overflow: hidden;
    }

    .logo::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.4), transparent);
      animation: shimmer 3s ease-in-out infinite;
    }

    .logo img,
    .logo svg {
      width: 90px;
      height: 48px;
      object-fit: contain;
      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
      animation: logoImagePulse 2s ease-in-out infinite;
      color: var(--accent-gold);
    }

    .logo svg path,
    .logo svg g {
      fill: var(--accent-gold);
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
    }

    /* Typography with premium styling */
    .app-title {
      color: var(--text-primary);
      font-size: clamp(32px, 5vw, 42px);
      font-weight: 800;
      text-align: center;
      margin-bottom: 12px;
      letter-spacing: 1.5px;
      background: linear-gradient(135deg, var(--text-primary), var(--accent-gold));
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
      animation: titleGlow 3s ease-in-out infinite;
      position: relative;
    }

    .app-title::after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--accent-gold), transparent);
      animation: underlineExpand 2s ease-in-out infinite;
    }

    .app-subtitle {
      color: var(--text-secondary);
      font-size: 18px;
      font-weight: 500;
      text-align: center;
      margin-bottom: 60px;
      letter-spacing: 0.8px;
      opacity: 0.9;
      animation: subtitleFade 2s ease-in-out infinite;
    }

    /* Advanced loading indicator */
    .loading-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 24px;
    }

    .loading-spinner-container {
      position: relative;
      width: 80px;
      height: 80px;
    }

    .loading-spinner {
      width: 80px;
      height: 80px;
      border: 3px solid rgba(255, 215, 0, 0.2);
      border-top: 3px solid var(--accent-gold);
      border-radius: 50%;
      animation: spinFast 1.2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
      position: relative;
    }

    .loading-spinner::before {
      content: '';
      position: absolute;
      top: -3px;
      left: -3px;
      right: -3px;
      bottom: -3px;
      border: 2px solid transparent;
      border-top: 2px solid var(--accent-gold-muted);
      border-radius: 50%;
      animation: spinSlow 2s linear infinite reverse;
    }

    .loading-progress {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 60px;
      height: 60px;
      background: radial-gradient(circle, var(--accent-gold-dark), var(--accent-gold));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
      animation: progressPulse 1.5s ease-in-out infinite;
    }

    .progress-icon {
      color: var(--primary-dark);
      font-size: 24px;
      font-weight: bold;
      animation: iconRotate 3s ease-in-out infinite;
    }

    .loading-text {
      color: var(--text-tertiary);
      font-size: 16px;
      font-weight: 500;
      text-align: center;
      letter-spacing: 0.5px;
      animation: textPulse 2s ease-in-out infinite;
    }

    .loading-dots {
      display: inline-block;
      animation: dots 1.5s ease-in-out infinite;
    }

    /* Premium animations */
    @keyframes backgroundShift {

      0%,
      100% {
        transform: translateX(0) translateY(0);
      }

      25% {
        transform: translateX(5px) translateY(-5px);
      }

      50% {
        transform: translateX(-3px) translateY(3px);
      }

      75% {
        transform: translateX(3px) translateY(5px);
      }
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0px) rotate(0deg);
        opacity: 0.6;
      }

      50% {
        transform: translateY(-20px) rotate(180deg);
        opacity: 1;
      }
    }

    @keyframes logoFloat {

      0%,
      100% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-10px);
      }
    }

    @keyframes logoRotate {

      0%,
      100% {
        transform: rotateY(0deg) rotateZ(0deg);
      }

      25% {
        transform: rotateY(5deg) rotateZ(1deg);
      }

      50% {
        transform: rotateY(0deg) rotateZ(0deg);
      }

      75% {
        transform: rotateY(-5deg) rotateZ(-1deg);
      }
    }

    @keyframes logoImagePulse {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.05);
      }
    }

    @keyframes pulseGlow {

      0%,
      100% {
        transform: scale(1);
        opacity: 0.3;
      }

      50% {
        transform: scale(1.1);
        opacity: 0.5;
      }
    }

    @keyframes rotate {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    @keyframes shimmer {
      0% {
        left: -100%;
      }

      100% {
        left: 100%;
      }
    }

    @keyframes titleGlow {

      0%,
      100% {
        filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.3));
        transform: translateY(0px);
      }

      50% {
        filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.5));
        transform: translateY(-2px);
      }
    }

    @keyframes underlineExpand {

      0%,
      100% {
        width: 60px;
        opacity: 0.7;
      }

      50% {
        width: 80px;
        opacity: 1;
      }
    }

    @keyframes subtitleFade {

      0%,
      100% {
        opacity: 0.9;
      }

      50% {
        opacity: 0.7;
      }
    }

    @keyframes spinFast {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    @keyframes spinSlow {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    @keyframes progressPulse {

      0%,
      100% {
        transform: translate(-50%, -50%) scale(1);
        box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
      }

      50% {
        transform: translate(-50%, -50%) scale(1.1);
        box-shadow: 0 0 40px rgba(255, 215, 0, 0.8);
      }
    }

    @keyframes iconRotate {

      0%,
      100% {
        transform: rotate(0deg);
      }

      50% {
        transform: rotate(360deg);
      }
    }

    @keyframes textPulse {

      0%,
      100% {
        opacity: 0.8;
      }

      50% {
        opacity: 1;
      }
    }

    @keyframes dots {

      0%,
      20% {
        color: transparent;
        text-shadow: .25em 0 0 transparent, .5em 0 0 transparent;
      }

      40% {
        color: var(--text-tertiary);
        text-shadow: .25em 0 0 transparent, .5em 0 0 transparent;
      }

      60% {
        text-shadow: .25em 0 0 var(--text-tertiary), .5em 0 0 transparent;
      }

      80%,
      100% {
        text-shadow: .25em 0 0 var(--text-tertiary), .5em 0 0 var(--text-tertiary);
      }
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Staggered animations for elements */
    .content-wrapper>* {
      animation: slideUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
      opacity: 0;
    }

    .logo-container {
      animation-delay: 0.2s;
    }

    .app-title {
      animation-delay: 0.4s;
    }

    .app-subtitle {
      animation-delay: 0.6s;
    }

    .loading-section {
      animation-delay: 0.8s;
    }

    /* Responsive design */
    @media (max-width: 768px) {
      .logo-wrapper {
        width: 120px;
        height: 120px;
      }

      .logo {
        width: 120px;
        height: 120px;
      }

      .logo img {
        width: 70px;
        height: 70px;
      }

      .logo-ring {
        width: 140px;
        height: 140px;
        top: -10px;
        left: -10px;
      }

      .app-title {
        font-size: 28px;
      }

      .app-subtitle {
        font-size: 16px;
        margin-bottom: 40px;
      }

      .loading-spinner-container {
        width: 60px;
        height: 60px;
      }

      .loading-spinner {
        width: 60px;
        height: 60px;
      }

      .loading-progress {
        width: 45px;
        height: 45px;
      }

      .progress-icon {
        font-size: 18px;
      }
    }

    @media (max-width: 480px) {
      .logo-wrapper {
        width: 100px;
        height: 100px;
      }

      .logo {
        width: 100px;
        height: 100px;
      }

      .logo img {
        width: 60px;
        height: 60px;
      }

      .app-title {
        font-size: 24px;
      }

      .loading-text {
        font-size: 14px;
      }
    }
  </style>
</head>

<body>
  <!-- Loading screen -->
  <div id="loading-container" class="loading-container">
    <!-- Floating particles background -->
    <div class="particles">
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
    </div>

    <!-- Main content -->
    <div class="content-wrapper">
      <!-- Logo section with premium effects -->
      <div class="logo-container">
        <div class="logo-wrapper">
          <div class="logo-background"></div>
          <div class="logo-ring"></div>
          <div class="logo">
            <svg width="90" height="48" viewBox="0 0 159.77333 84.173332" xmlns="http://www.w3.org/2000/svg">
              <!-- Metropolitan Investment SVG Logo (background removed) -->
              <g id="logo-content">
                <!-- Main METROPOLITAN text -->
                <path
                  d="m 162.859,267.559 -22.386,-29.84 h -2.555 l -21.891,29.941 v -49.972 h -12.961 v 68.726 h 14.922 l 21.504,-29.551 21.5,29.551 h 14.828 v -68.726 h -12.961 z m 96.012,-49.766 h -51.445 c 0,22.871 0,45.848 0,68.719 h 51.445 v -12.567 h -38.582 v -15.804 h 37.207 v -12.078 h -37.207 v -15.516 h 38.582 z m 51.434,56.937 h -21.793 v 11.782 c 19.836,0 36.625,0 56.554,0 V 274.73 H 323.27 V 217.793 H 310.305 Z M 433.52,217.793 h -15.418 l -20.028,22.969 h -12.469 v -22.969 h -12.96 v 68.816 c 10.902,0 21.8,-0.097 32.695,-0.097 16.199,-0.098 24.742,-10.895 24.742,-22.778 0,-9.425 -4.32,-18.949 -17.379,-21.597 l 20.817,-23.469 z m -47.915,56.641 v 0 -21.985 h 19.735 c 8.246,0 11.781,5.492 11.781,10.992 0,5.493 -3.633,10.993 -11.781,10.993 z m 140.387,-22.676 c -0.191,-17.77 -11.094,-35.543 -35.242,-35.543 -24.152,0 -35.348,17.379 -35.348,35.441 0,18.071 11.586,36.231 35.348,36.231 23.66,0 35.445,-18.16 35.242,-36.129 z m -57.824,-0.293 v 0 c 0.297,-11.289 6.379,-23.371 22.582,-23.371 16.199,0 22.289,12.176 22.48,23.469 0.2,11.582 -6.281,24.542 -22.48,24.542 -16.203,0 -22.879,-13.054 -22.582,-24.64 z m 119.379,-13.457 h -19.442 v -20.215 h -12.96 v 68.719 c 10.8,0 21.601,0.097 32.402,0.097 33.582,0 33.676,-48.601 0,-48.601 z m -19.442,11.879 v 0 h 19.442 c 16.594,0 16.492,24.351 0,24.351 h -19.442 z m 140.586,1.871 c -0.195,-17.77 -11.089,-35.543 -35.242,-35.543 -24.156,0 -35.347,17.379 -35.347,35.441 0,18.071 11.586,36.231 35.347,36.231 23.66,0 35.442,-18.16 35.242,-36.129 z m -57.824,-0.293 v 0 c 0.297,-11.289 6.379,-23.371 22.582,-23.371 16.199,0 22.285,12.176 22.485,23.469 0.195,11.582 -6.286,24.542 -22.485,24.542 -16.203,0 -22.879,-13.054 -22.582,-24.64 z m 99.942,35.047 v -56.746 h 35.343 v -11.973 h -48.304 v 68.719 z m 64.199,-68.719 v 68.719 h 12.863 v -68.719 z m 65.578,56.937 h -21.797 v 11.782 c 19.836,0 36.625,0 56.559,0 V 274.73 h -21.793 v -56.937 h -12.969 z m 111.031,-43.98 h -35.929 l -5.891,-12.957 h -14.039 l 30.828,68.719 h 14.137 l 30.837,-68.719 h -14.142 z m -17.965,41.328 v 0 l -12.757,-29.254 h 25.527 z m 108.588,14.531 h 12.95 v -68.816 h -8.05 v -0.105 l -36.13,46.437 v -46.332 h -12.96 v 68.719 h 10.51 l 33.68,-42.606 v 42.703"
                  fill="currentColor" transform="matrix(0.13333333,0,0,-0.13333333,0,84.173333)" />

                <!-- "Investment" subtitle -->
                <g fill="currentColor" transform="matrix(0.13333333,0,0,-0.13333333,0,84.173333)">
                  <path d="m 351.273,152.938 h 5.54 v -49.032 h -5.54 v 49.032" />
                  <path
                    d="m 383.828,140.117 h 5.391 v -6.301 c 2.383,3.918 6.164,7.075 12.398,7.075 8.754,0 13.867,-5.883 13.867,-14.504 v -22.481 h -5.394 v 21.153 c 0,6.726 -3.641,10.925 -10.016,10.925 -6.23,0 -10.855,-4.55 -10.855,-11.343 v -20.735 h -5.391 v 36.211" />
                  <path
                    d="m 434.984,140.117 h 5.954 l 12.187,-30.047 12.258,30.047 h 5.812 l -15.761,-36.488 h -4.758 l -15.692,36.488" />
                  <path
                    d="m 517.109,124.148 c -0.629,6.586 -4.414,12.188 -11.558,12.188 -6.231,0 -10.996,-5.184 -11.766,-12.188 z m -10.578,-16.386 c 4.973,0 8.477,2.031 11.418,5.113 l 3.36,-3.016 c -3.637,-4.062 -8.051,-6.793 -14.918,-6.793 -9.946,0 -18.067,7.633 -18.067,18.914 0,10.5 7.356,18.911 17.367,18.911 10.715,0 16.883,-8.547 16.883,-19.196 0,-0.488 0,-1.05 -0.074,-1.89 h -28.715 c 0.77,-7.629 6.375,-12.043 12.746,-12.043" />
                  <path
                    d="m 543.422,108.531 2.73,3.852 c 3.922,-2.942 8.266,-4.621 12.539,-4.621 4.34,0 7.493,2.242 7.493,5.742 v 0.141 c 0,3.64 -4.27,5.043 -9.036,6.371 -5.671,1.613 -11.976,3.574 -11.976,10.226 v 0.141 c 0,6.234 5.183,10.367 12.328,10.367 4.414,0 9.316,-1.543 13.027,-3.996 l -2.449,-4.063 c -3.367,2.172 -7.219,3.5 -10.719,3.5 -4.273,0 -7.004,-2.238 -7.004,-5.246 v -0.144 c 0,-3.43 4.485,-4.758 9.317,-6.235 5.601,-1.679 11.629,-3.851 11.629,-10.359 v -0.144 c 0,-6.864 -5.676,-10.852 -12.891,-10.852 -5.183,0 -10.926,2.031 -14.988,5.32" />
                  <path
                    d="m 596.633,113.504 v 21.848 h -5.043 v 4.765 h 5.043 v 10.926 h 5.39 v -10.926 h 11.489 v -4.765 h -11.489 v -21.145 c 0,-4.414 2.45,-6.027 6.094,-6.027 1.821,0 3.363,0.351 5.254,1.261 v -4.625 c -1.891,-0.976 -3.922,-1.539 -6.516,-1.539 -5.808,0 -10.222,2.871 -10.222,10.227" />
                  <path
                    d="m 638.297,140.117 h 5.391 v -6.094 c 2.382,3.571 5.605,6.868 11.699,6.868 5.879,0 9.668,-3.157 11.633,-7.219 2.585,3.996 6.433,7.219 12.742,7.219 8.332,0 13.449,-5.606 13.449,-14.571 v -22.414 h -5.391 v 21.153 c 0,7.004 -3.507,10.925 -9.386,10.925 -5.469,0 -10.016,-4.058 -10.016,-11.207 v -20.871 h -5.324 v 21.289 c 0,6.797 -3.574,10.789 -9.317,10.789 -5.742,0 -10.089,-4.761 -10.089,-11.418 v -20.66 h -5.391 v 36.211" />
                  <path
                    d="m 743.297,124.148 c -0.637,6.586 -4.414,12.188 -11.563,12.188 -6.23,0 -10.996,-5.184 -11.765,-12.188 z m -10.574,-16.386 c 4.968,0 8.472,2.031 11.414,5.113 l 3.359,-3.016 c -3.644,-4.062 -8.058,-6.793 -14.922,-6.793 -9.941,0 -18.066,7.633 -18.066,18.914 0,10.5 7.351,18.911 17.375,18.911 10.711,0 16.875,-8.547 16.875,-19.196 0,-0.488 0,-1.05 -0.07,-1.89 h -28.719 c 0.769,-7.629 6.375,-12.043 12.754,-12.043" />
                  <path
                    d="m 771.488,140.117 h 5.391 v -6.301 c 2.383,3.918 6.164,7.075 12.394,7.075 8.758,0 13.868,-5.883 13.868,-14.504 v -22.481 h -5.391 v 21.153 c 0,6.726 -3.645,10.925 -10.02,10.925 -6.23,0 -10.851,-4.55 -10.851,-11.343 v -20.735 h -5.391 v 36.211" />
                  <path
                    d="m 830.074,113.504 v 21.848 h -5.039 v 4.765 h 5.039 v 10.926 h 5.399 v -10.926 h 11.488 v -4.765 h -11.488 v -21.145 c 0,-4.414 2.453,-6.027 6.093,-6.027 1.817,0 3.36,0.351 5.247,1.261 v -4.625 c -1.887,-0.976 -3.918,-1.539 -6.504,-1.539 -5.821,0 -10.235,2.871 -10.235,10.227" />
                </g>

                <!-- Architectural columns icon -->
                <g fill="currentColor" transform="matrix(0.13333333,0,0,-0.13333333,0,84.173333)">
                  <path d="m 513.23,363.922 h 32.723 V 487.16 L 513.23,514.227 V 363.922" />
                  <path d="m 566.406,363.922 h 32.727 V 498.414 L 566.406,480.047 V 363.922" />
                  <path d="m 619.586,363.922 h 32.727 V 528.266 L 619.586,509.895 V 363.922" />
                </g>
              </g>
            </svg>
          </div>
        </div>
      </div>

      <!-- App branding -->
      <h1 class="app-title">Metropolitan Investment</h1>
      <p class="app-subtitle">Professional Investment Management Platform</p>

      <!-- Loading section -->
      <div class="loading-section">
        <p class="loading-text">Inicjalizacja platformy inwestycyjnej<span class="loading-dots">...</span></p>
      </div>
    </div>
  </div>

  <script>
    // Enhanced loading experience with premium animations
    let loadingProgress = 0;
    let loadingSteps = [
      'Nawiązywanie bezpiecznego połączenia...',
      'Weryfikacja autoryzacji użytkownika...',
      'Ładowanie danych portfela...',
      'Inicjalizacja interfejsu analitycznego...',
      'Przygotowywanie pulpitu inwestycyjnego...',
      'Finalizacja konfiguracji...'
    ];
    let currentStepIndex = 0;

    // Function to update loading text
    function updateLoadingText() {
      const loadingTextElement = document.querySelector('.loading-text');
      if (loadingTextElement && currentStepIndex < loadingSteps.length) {
        loadingTextElement.innerHTML = loadingSteps[currentStepIndex] + '<span class="loading-dots">...</span>';
        currentStepIndex++;
      }
    }

    // Simulate loading progress with realistic steps
    function simulateLoadingProgress() {
      const interval = setInterval(() => {
        loadingProgress += Math.random() * 15 + 10;
        updateLoadingText();

        if (loadingProgress >= 100) {
          clearInterval(interval);
          loadingProgress = 100;
        }
      }, 800);
    }

    // Start loading simulation
    setTimeout(() => {
      simulateLoadingProgress();
    }, 1000);

    // Hide loading screen when Flutter app is ready
    window.addEventListener('flutter-first-frame', function () {
      const loadingContainer = document.getElementById('loading-container');
      if (loadingContainer) {
        // Add premium fade-out effect
        loadingContainer.style.transition = 'all 1.2s cubic-bezier(0.4, 0, 0.2, 1)';
        loadingContainer.classList.add('fade-out');

        setTimeout(() => {
          loadingContainer.style.display = 'none';
        }, 1200);
      }
    });

    // Enhanced fallback with longer timeout for complex apps
    setTimeout(() => {
      const loadingContainer = document.getElementById('loading-container');
      if (loadingContainer && !loadingContainer.classList.contains('fade-out')) {
        console.log('Metropolitan Investment: Loading timeout reached, showing app...');
        loadingContainer.style.transition = 'all 1.2s cubic-bezier(0.4, 0, 0.2, 1)';
        loadingContainer.classList.add('fade-out');

        setTimeout(() => {
          loadingContainer.style.display = 'none';
        }, 1200);
      }
    }, 15000); // Extended timeout for financial app complexity

    // Add premium loading sound effect (optional)
    function playLoadingSound() {
      // Subtle audio feedback for premium experience
      try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();

        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);

        oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.1);

        gainNode.gain.setValueAtTime(0, audioContext.currentTime);
        gainNode.gain.linearRampToValueAtTime(0.02, audioContext.currentTime + 0.01);
        gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.1);

        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.1);
      } catch (e) {
        // Graceful fallback if audio not supported
      }
    }

    // Trigger subtle sound on load (user interaction dependent)
    document.addEventListener('click', function () {
      playLoadingSound();
    }, { once: true });

    // Add performance monitoring
    if ('performance' in window) {
      window.addEventListener('load', function () {
        setTimeout(() => {
          const perfData = performance.getEntriesByType('navigation')[0];
          console.log('Metropolitan Investment Loading Performance:', {
            domContentLoaded: perfData.domContentLoadedEventEnd - perfData.domContentLoadedEventStart,
            totalLoad: perfData.loadEventEnd - perfData.loadEventStart,
            domInteractive: perfData.domInteractive - perfData.fetchStart
          });
        }, 0);
      });
    }

  // === SERVICE WORKER CACHE FIX ===
  // Fix for "Partial response (status code 206) is unsupported" error
  if ('serviceWorker' in navigator) {
    // Override the default service worker registration to handle cache errors
    const originalRegister = navigator.serviceWorker.register;
    navigator.serviceWorker.register = function (scriptURL, options) {
      return originalRegister.call(this, scriptURL, options).then(function (registration) {
        // Add error handling for cache operations
        registration.addEventListener('message', function (event) {
          if (event.data && event.data.type === 'cache-error') {
            console.warn('Metropolitan Investment: Service worker cache error handled:', event.data.error);
          }
        });

        // Monitor for cache errors
        if ('caches' in window) {
          // Override cache.put to handle partial responses
          const originalPut = Cache.prototype.put;
          Cache.prototype.put = function (request, response) {
            // Check if response is partial (206)
            if (response.status === 206) {
              console.warn('Metropolitan Investment: Skipping cache of partial response for:', request.url);
              return Promise.resolve(); // Skip caching partial responses
            }
            return originalPut.call(this, request, response);
          };
        }

        return registration;
      }).catch(function (error) {
        console.error('Metropolitan Investment: Service worker registration failed:', error);
        // Continue without service worker if registration fails
        return null;
      });
    };
  }

  // === FIREBASE OAUTH DOMAIN FIX ===
  // Handle OAuth domain authorization errors
  window.addEventListener('error', function (event) {
    if (event.message && event.message.includes('OAuth') && event.message.includes('domain')) {
      console.warn('Metropolitan Investment: OAuth domain authorization issue detected. Please add your domain to Firebase Console.');
      console.warn('Required action: Go to Firebase Console > Authentication > Settings > Authorized domains');
      console.warn('Add domain: metropolitan-investment.pl');
    }
  });

  // Enhanced error handling for Firebase operations
  window.addEventListener('unhandledrejection', function (event) {
    if (event.reason && event.reason.message) {
      if (event.reason.message.includes('OAuth') || event.reason.message.includes('domain')) {
        console.warn('Metropolitan Investment: Firebase OAuth domain issue:', event.reason.message);
        event.preventDefault(); // Prevent default error handling
      }
    }
  });
  </script>

  <script src="flutter_bootstrap.js" async></script>
<!-- Custom Service Worker for Metropolitan Investment -->
<script>
  // Register custom service worker with enhanced error handling
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', function () {
      navigator.serviceWorker.register('flutter_service_worker.js')
        .then(function (registration) {
          console.log('Metropolitan Investment: Service worker registered successfully');

          // Handle service worker updates
          registration.addEventListener('updatefound', function () {
            const newWorker = registration.installing;
            if (newWorker) {
              newWorker.addEventListener('statechange', function () {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  // New version available
                  console.log('Metropolitan Investment: New service worker version available');
                  // Optionally show update notification to user
                }
              });
            }
          });

          // Listen for messages from service worker
          navigator.serviceWorker.addEventListener('message', function (event) {
            if (event.data && event.data.type === 'cache-error') {
              console.warn('Metropolitan Investment: Service worker cache error:', event.data);
            }
          });
        })
        .catch(function (error) {
          console.error('Metropolitan Investment: Service worker registration failed:', error);
          // Continue without service worker - app will still work
        });
    });
  }
</script>
</body>

</html>